CVE-2013-0864
=============

- Fixed in `c10350358da58600884292c08a8690289b81de29`
- https://www.cvedetails.com/cve/CVE-2013-0864/
- All commands are run from the top level directory of this repository.

Compile
-------

To compile on *linux*, run the following:

```
# Compiling with `clang -flto` produces LLVM bitcode instead of normal object files
./configure --disable-asm --disable-doc --cc='clang -flto' --cxx='clang++ -flto' \
    --enable-small \
    --disable-everything --enable-protocol=file --enable-demuxer=gif --enable-decoder=gif \
    --enable-encoder=rawvideo --enable-muxer=null --disable-filter=null

bash CVE-2013-0864/build.sh
```

The build process is described in more detail in `build.sh`.
These are instructions for compiling on *OS X* with `llvm@9` installed via brew.

```
# Compiling with `clang -flto` produces LLVM bitcode instead of normal object files
./configure --disable-asm --disable-doc --cc='clang-9 -flto -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk' --cxx='clang++-9 -flto -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk' \
    --enable-small \
    --disable-everything --enable-protocol=file --enable-demuxer=gif --enable-decoder=gif \
    --enable-encoder=rawvideo --enable-muxer=null --disable-filter=null

LLVM_SUFFIX=-9 bash CVE-2013-0864/build.sh
```

Read a GIF
----------

Read in a GIF:

```
./driver CVE-2013-0864/jerry.gif
```

This runs the GIF decoder but simply discards the video stream.

Trigger vulnerability
---------------------

Trigger buffer overflow by attempting to read a bad GIF:

```
./driver CVE-2013-0864/payload.gif
```

This consistently triggers a segmentation fault on my system (OS X) when compiled with Apple LLVM version 10.0.1 (clang-1001.0.46.4).

Payload modified from [here](https://66.media.tumblr.com/5a646387587dd017f65b3742951670b3/tumblr_mjq8ocHhEE1rpur03o1_400.gifv).

System calls
------------

Trace the system calls with the payload.

```
strace -o CVE-2013-0864/strace_out.txt -c -- ./driver CVE-2013-0864/payload.gif
```

